<div class="main" (window:resize)="onResize($event)">
  <div *ngIf="devButtonsShowing.value">
    <div
      style="
        position: fixed;
        z-index: 5;
        margin-top: -50px;
        background-color: hotpink;
        text-align: center;
        width: 100px;
        height: 25px;
      "
    >
      {{ this.DEV_timeOfBuild }}
    </div>
    <button
      (click)="devEvent()"
      style="position: fixed; z-index: 5; margin-top: -30px;"
    >
      CHECK PERMS
    </button>
    <button
      (click)="socketToLocalHost()"
      style="position: fixed; z-index: 5; margin-top: -10px;"
      [style.backgroundColor]="DEV_socketUsingLocal.value ? 'red' : 'lightgrey'"
    >
      SOCKET LOCAL
    </button>
    <button
      (click)="setHard5x9()"
      style="position: fixed; z-index: 5; margin-top: 10px;"
      [style.backgroundColor]="DEV_hard9x5.value ? 'red' : 'lightgrey'"
    >
      HARD 9x5
    </button>
    <button
      (click)="devEvent2()"
      style="position: fixed; z-index: 5; margin-top: 30px;"
    >
      SOCKET STOP
    </button>
  </div>
  <form class="grid" [formGroup]="makeCrosswordForm" (ngSubmit)="devEvent()">
    <div *ngIf="!DEV_onlyShowResultBox" class="box box1" id="box1">
      <div class="tag hiddenTag">required</div>

      <div class="boxLayerA" [class.veiled]="false">
        <p class="boxTitle boxTitleA">Grid Shape</p>

        <br />
        <br />
        <form formGroupName="shape">
          <div class="slideshowContainer">
            <div
              *ngFor="let slideData of slidesData"
              class="slide"
              id="{{ slideData.id }}"
              ngClass="{{ slideData.class }}"
            >
              <label class="slideLabel">
                <input
                  class="shapeRadio"
                  type="radio"
                  value="{{ slideData.value }}"
                  formControlName="shapeName"
                  (click)="formChanged()"
                  (click)="checkShapeRadio(slideData.id)"
                  [class.shapeRadioChecked]="slideData.checked"
                />
                <div class="insideLabelToCollectClick">
                  <div class="gridImageHolder">
                    <img
                      class="slideImage"
                      [class.grayedOut]="!slideData.checked"
                      src="{{ slideData.src }}"
                    />
                  </div>
                  <p
                    class="shapeText"
                    [style.opacity]="slideData.checked ? 1 : 0.4"
                  >
                    {{ slideData.value }}
                  </p>
                </div>
              </label>
            </div>
          </div>

          <a class="slidePrev" (click)="rotateCarousel(1)">
            &#10094;
          </a>
          <a class="slideNext" (click)="rotateCarousel(0)">&#10095;</a>
          <br />
        </form>
      </div>

      <div class="boxLayerB">
        <img class="crocSep crocSepL" src="../../assets/croc-silh-g-m.png" />
      </div>

      <div class="boxLayerC" *ngIf="false"></div>
    </div>

    <div *ngIf="!DEV_onlyShowResultBox" class="box box2" id="box2">
      <div class="tag">optional</div>

      <div
        class="boxLayerA"
        [class.veiled]="helpDisplay.MandLeng.show || helpDisplay.MandPoss.show"
      >
        <p class="boxTitle boxTitleB">
          Mandatory or Forbidden Words
        </p>

        <div class="insideBoxTwo">
          <label>
            <p>
              Each grid must include:
            </p>
            <textarea
              class="inputBox inputBoxMand"
              placeholder="eg Santa claus"
              formControlName="mand"
              (keypress)="formChanged()"
            ></textarea>
          </label>
          <label>
            <p>
              Each grid must exclude:
            </p>
            <textarea
              class="inputBox inputBoxForb"
              formControlName="bann"
              placeholder="eg miffs fiats"
              (keypress)="formChanged()"
            ></textarea>
          </label>
        </div>
        <br />
        Separate your words with a space.
        <br />
        <br />
        Best results with no more than three mandatory words.
      </div>

      <div class="boxLayerB">
        <img
          (click)="showDevButtons()"
          class="crocSep crocSepR flipHorizontal"
          src="../../assets/croc-silh-g-m.png"
        />
      </div>

      <div
        class="boxLayerC"
        *ngIf="helpDisplay.MandLeng.show || helpDisplay.MandPoss.show"
      >
        <img
          class="speechBubble flipHorizontal"
          src="../../assets/speech_bubble3.png"
        />
        <div
          class="speechBubbleTextbox"
          (click)="exitErrorBubble(helpDisplay.current)"
        >
          <p class="speechBubbleText">
            {{ helpDisplay[helpDisplay.current].text }}
          </p>
        </div>
      </div>
    </div>

    <div *ngIf="!DEV_onlyShowResultBox" class="box box3" id="box3">
      <div class="tag">optional</div>

      <div
        class="boxLayerA"
        [class.veiled]="
          helpDisplay.DesiLeng.show ||
          helpDisplay.DesiThre.show ||
          helpDisplay.DesiQuot.show
        "
      >
        <p class="boxTitle boxTitleC">Desirable Words</p>

        <p>
          Say, a large bank of words you've already made clues for.
          <br />
          Best results when minimum isn't set higher than three.
        </p>
        <textarea
          formControlName="desi"
          class="inputBox inputBoxDesi"
          placeholder="{{ desiPlaceholderText }}"
          (keypress)="formChanged()"
        ></textarea>
        <div class="desiButtonHolder">
          <div>
            <input
              class="desiButton"
              checked
              type="radio"
              formControlName="desiSeparator"
              id="space"
              value=" "
              (click)="updateDesiPlaceholderText('space')"
              (click)="formChanged()"
            />
            <label for="space" class="desiDetectLabel">
              Detect words by space</label
            >
          </div>
          <div>
            <input
              class="desiButton"
              type="radio"
              formControlName="desiSeparator"
              id="marks"
              value='"'
              (click)="updateDesiPlaceholderText('marks')"
              (click)="formChanged()"
            />
            <label for="marks" class="desiDetectLabel">
              Detect words by speechmarks</label
            >
          </div>
        </div>

        <div class="includeAtLeast_box">
          <p class="includeAtLeast_text">
            Include at least
          </p>

          <textarea
            class="threshInputBox"
            id="threshInputBox"
            placeholder="0"
            maxlength="2"
            formControlName="threshold"
            (keypress)="formChanged()"
            (click)="clearInputBox('threshold')"
          ></textarea>
          <p class="includeAtLeast_text">
            of these words
          </p>
        </div>
      </div>

      <div class="boxLayerB">
        <img class="crocSep crocSepL" src="../../assets/croc-silh-g-m.png" />
      </div>

      <div
        class="boxLayerC"
        *ngIf="
          helpDisplay.DesiLeng.show ||
          helpDisplay.DesiThre.show ||
          helpDisplay.DesiQuot.show
        "
      >
        <img class="speechBubble" src="../../assets/speech_bubble3.png" />
        <div
          class="speechBubbleTextbox"
          (click)="exitErrorBubble(helpDisplay.current)"
        >
          <p class="speechBubbleText">
            {{ helpDisplay[helpDisplay.current].text }}
          </p>
        </div>
      </div>
    </div>

    <div
      class="box box4"
      id="box4"
      (mouseover)="makeElementSelected('box4', true)"
      (mouseout)="makeElementSelected('box4', false)"
    >
      <div class="resultLeftie">
        <div
          *ngIf="results.array.length"
          class="resultLeftieInner1"
          id="resultLeftieInner1"
          [style]="
            transparentResults.value ? 'color: transparent;' : 'color: black;'
          "
        >
          <div
            *ngFor="let coordArr of results.array[results.index].grid"
            class="hor"
            ngClass="{{ 'horMargin' + results.array[results.index].margin }}"
          >
            <p class="coordName">{{ coordArr[0] | formatCoord }}</p>
            <p class="coordWords">{{ coordArr[1] | spaceArray }}</p>
          </div>
        </div>
      </div>
      <div
        class="resultRightie"
        [class.resultRightieActive]="serverIsIndeedWorking.value"
      >
        <button
          class="startStopButton"
          [class.started]="startButtonActive.value"
          [class.ready]="socketIsReady.value || DEV_deactivateSocket"
          [class.disabled]="!socketIsReady.value || DEV_deactivateSocket"
          type="button"
          (click)="
            socketIsReady.value && startButtonActive.value && socketStop()
          "
          (click)="
            ((socketIsReady.value && !startButtonActive.value) ||
              DEV_deactivateSocket) &&
              socketEmit()
          "
        >
          {{
            socketIsReady.value
              ? startButtonActive.value
                ? "STOP"
                : "MAKE GRIDS"
              : "connecting..."
          }}
        </button>
        <div *ngIf="results.array.length">
          <p
            *ngFor="let line of results.array[results.index].summary"
            class="gridRender"
          >
            {{ line }}
          </p>
        </div>
        <div class="rightieOverlay">
          <div
            *ngIf="disconnectedByServer.value && !results.array.length"
            class="loadingMessageContainer"
            style="margin-bottom: 40px;"
          >
            <img class="loadingIconLarge" src="../../assets/croc-book.png" />
            <p class="loadingText">
              Sorry, none yet, but please try again!
            </p>
          </div>
          <div
            *ngIf="
              startButtonActive.value &&
              !serverIsIndeedWorking.value &&
              !results.array.length
            "
            class="loadingMessageContainer"
          >
            <img class="loadingIcon" src="../../assets/sending icon ZEUS.png" />
            <p class="loadingText">Sending to server...</p>
          </div>
          <div
            *ngIf="
              startButtonActive.value &&
              serverIsIndeedWorking.value &&
              !results.array.length
            "
            class="loadingMessageContainer"
          >
            <img class="loadingIcon" src="../../assets/working icon ZEUS.png" />
            <p class="loadingText">Server is working...</p>
          </div>

          <div class="tinyIconContainer">
            <span
              tooltip="Download all results"
              placement="bottom"
              [show-delay]="0"
              [hide-delay]="0"
            >
              <img
                class="tinyIcon"
                src="../../assets/download icon ZEUS.png"
                (click)="clickToDownload()"
            /></span>
            <span
              tooltip="Report problems"
              placement="bottom"
              [show-delay]="0"
              [hide-delay]="0"
            >
              <img
                class="tinyIcon"
                src="../../assets/report icon ZEUS.png"
                (click)="clickToReport()"
            /></span>
          </div>
        </div>
        <div class="indexDisplay">
          {{
            results.array.length
              ? results.index + 1 + " of " + results.array.length
              : ""
          }}
        </div>
      </div>

      <div class="resultScroll">
        <button
          type="button"
          class="scrollButton scrollUp"
          (click)="changeResultsIndex('up')"
        >
          ▲
        </button>
        <button
          type="button"
          class="scrollButton scrollDown"
          (click)="changeResultsIndex('down')"
        >
          ▼
        </button>
      </div>
    </div>
  </form>
</div>
